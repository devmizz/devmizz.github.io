---
title: "조회 실패에 대한 Error code"

categories:
  - Spring

tags:
  - HTTP상태코드

toc: true
toc_label: 목차
toc_sticky: true
toc_icon: list

date: 2022-05-22
last_modified_at: 2022-05-22
---

## 1. 조회 실패

이런 상황을 한 번 생각해보자.

> 클라이언트에서 어떤 파라미터를 통해 서버에 데이터 조회를 요청했으며, 요청한 자료는 정상적이라고 해보자(Bad Request는 아니라는 의미). 그런데 전달받은 파라미터로 서버가 DB에 조회를 했더니 데이터가 없다. 이럴 때 서버는 클라이언트에게 어떤 응답을 줄 것인가.

이에 대한 나의 대답은 다음과 같았다.

`서버와 통신은 성공한 것이니 200(OK)을 주면서 실패 내용에 대한 커스터마이징을 하자!`

이 경우에 일반적으로는 다음과 같은 응답을 할 것이다.

```JSON
{
  "message": "can't find",
  "code": "200",
  "body": "null"
}
```

그러나 위와 같은 응답은 200이 의미하는 바와는 다르다고 생각한다.

[![200](https://velog.velcdn.com/images/beatoncheeze/post/055ece70-57ec-4a37-ae89-6b943aab434e/image.png)](https://developer.mozilla.org/ko/docs/Web/HTTP/Status/200 "모질라 200")

200(OK)는 엄연히 '요청'이 성공했음을 의미한다. '통신'의 성공을 의미하는 것이 아니므로, 위의 경우에서 200을 주는 것은 옳지 않다고 생각한다. 그럼 어떤 응답이 적절할까. 본인이 내린 결론은 404(Not Found)를 써야 한다는 것이다.

## 2. 404(Not Found)

왜 404를 써야하는 지에 대한 논의를 하기에 앞서, 404에 관한 이야기를 할 필요가 있다. 404에 대한 일반의 인식은 아래와 같다.

> _404(Not Found)는 요청한 페이지가 없는 경우에 사용한다._

그러나 나는 조금 다르게 생각한다. 모질라 문서에는 404가 다음과 같이 정의되어 있다.

[![404](https://velog.velcdn.com/images/beatoncheeze/post/c29929e0-f895-48ed-8cdd-b855fb81bef9/image.png)](https://developer.mozilla.org/ko/docs/Web/HTTP/Status/404 "모질라 404")

404(Not Found)는 서버가 요청받은 '리소스'를 찾을 수 없음을 의미한다. 404(Not Found) '페이지 없음'만으로 해석하기 위해서는 '리소스 = 페이지'라는 전제가 있어야 한다. 나는 위와 같은 전제와 그에 따른 해석이 404코드에 대한 적용 범위를 지나치게 좁히는 것이 아닌가 생각한다. 만약 404코드가 페이지 없음만을 의미하는 것이었다면 '리소스를 찾을 수 없다'가 아닌 '페이지를 찾을 수 없다'는 표현을 사용하지 않았을까.

## 3. 결론

위의 두 얘기를 요약하자면, 조회 실패에 대한 응답은 404(Not Found)를 줘야 한다는 것이다. 이에 대한 이유를 두 줄 요약하자면 다음과 같다.

> 1. 200은 '요청의 성공'을 의미한다. 조회가 되지 않았으므로 요청이 성공한 것은 아니다. 따라서 200은 쓰면 안 된다.
> 2. 404가 '페이지 없음'에 국한되는 것은 아니다. 데이터 없음도 '리소스 없음'이므로 404가 옳다.

응답을 받은 클라이언트 입장에서도 데이터 조회 실패에 대해 200을 받는 경우, 성공을 했는데 해당 데이터가 null인 것인지, 조회가 실패한 것인지 명확하지 않다. 위의 JSON처럼 에러 메세지를 별도로 표시하더라도, 서로 모순되는 코드와 내용이 함께 있는 상황이 적절하다고 생각되지는 않는다. 적절한 에러코드를 사용함으로써 클라이언트로 하여금 혼란이 없게 하는 것은 중요하다고 생각한다.

이보다 더 적절한 에러코드가 존재할 수도 있고, 혹은 404가 정말로 '페이지 없음'을 의도하며 설계되었을 수도 있다. 독스에 존재하는 정의를 바탕으로 나의 뇌피셜을 풀어놨을 뿐이기에, 얼마든지 다른 생각도 존재할 수 있다. 그런 의견들은 꼭 댓글에 남겨주셔서 저의 시야를 넓혀주셨으면 하는 바람이 있다.
